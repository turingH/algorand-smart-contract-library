# AI 审计方案 - AccessControl 管理员权限变更

## 已知前提
- `pk.md` 指出 `RateLimiter` 的溢出保护已被验证，仅在该模块与管理员变更逻辑产生联系时需要留意。

## 代码审查要点
1. **入口限制**
   - 搜索所有调用 `_set_role_admin` 的函数，确认外部入口（如 `set_role_admin`）是否首先检查调用者拥有目标角色的管理员权限。
   - 对内部调用场景，判断是否可能被未授权函数间接触发。
2. **事件准确性**
   - 阅读 `RoleAdminChanged` 事件的定义与触发位置，核对参数顺序（角色、旧管理员、新管理员）。
   - 检查是否遗漏关键事件，导致审计日志无法准确记录管理员变更。
3. **防误操作设计**
   - 如果管理员角色可自行修改其管理员，评估是否需要多签或延时机制以降低误改风险。
